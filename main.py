#!/usr/bin/env python2
"""
   NORX reference Python2 implementation.
   ------

   :copyright: (c) 2014 by Philipp Jovanovic <philipp@jovanovic.io>.
   :license: CC0, see LICENSE for more details.
"""
from norx import NORX

def vectors_G(w,i):

    x = {
        32: [ (0x00000001, 0x00000000, 0x00000000, 0x00000000),
              (0x00002001, 0x42024200, 0x21010100, 0x20010100),
              (0x8E6E6E29, 0x8783068E, 0x0FAD8F6F, 0x6D4A8F0C),
              (0x9D6D8718, 0xB987D564, 0xC7474857, 0x24F32605),
              (0xC291D60D, 0x19A0D5EA, 0xF0E0D424, 0xC473BBA3),
              (0x35F2578F, 0x853DBE90, 0x195D7490, 0x149F61EC),
              (0xAF557EEA, 0xC53796FE, 0x163271AC, 0x4E4F5CFB),
              (0xDBA043BC, 0x6C09B0BE, 0x4D7D55A3, 0x4425E08E),
              (0x44912C86, 0xE215F517, 0xD0614027, 0xA094B0F2),
              (0x88980FED, 0x27B1DE05, 0x79A35152, 0x3DCCE71E),
              (0xBD333CDB, 0xC51A4ECA, 0x6DA7579C, 0xF9F141A0),
              (0x9F85298E, 0xF2ACF75A, 0xD4CEBDA4, 0xD5A4BA0E),
              (0xFA2D9998, 0x3BD8B744, 0xAFE0677A, 0x1CBE34B0),
              (0x72B826FD, 0x30355A44, 0xD6CE9703, 0x7CC51E11),
              (0xC7053F6D, 0xD35DA308, 0xCD1616B8, 0x170BE75B),
              (0x29F7F20E, 0x3256FD7D, 0x068E6667, 0xAB330772)
            ],
        64: [ ( 0x0000000000000001, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000 ),
              ( 0x0000002000000001, 0x4200004002020000, 0x2100000001010000, 0x2000000001010000 ),
              ( 0x82600C6C420A0C61, 0x9CC80A07051612D8, 0x0E04090FC283050C, 0x6C22090F6183020C ),
              ( 0xCFE22B520239332F, 0x1A1C7E83367612BF, 0x7CD42AB6581A2C29, 0x4D6E1FA833FA9021 ),
              ( 0x3D5E2BDE88AFF93B, 0xECC8D95156DCEC38, 0x0A0446A133EE8271, 0xC0F5AC2CAED2D2BB ),
              ( 0xC3C467FE58784143, 0x3C97782DEEAC5790, 0x44843BC64A41A7D8, 0xB25B09F9540B8D94 ),
              ( 0xAC67C4758EDABE16, 0xC321E8CE8496C5ED, 0x2FBCC28DAA1D48B5, 0xA3FCA8310FEB2BC4 ),
              ( 0x4CE9BEBB0DD254A6, 0x4F2485BE02121466, 0xC67650560B60EF00, 0xBF0EDED6FE7B2547 ),
              ( 0xC2C12A34D0D5FD94, 0x1C191DA55351ADFA, 0x4149F615635943F5, 0xD8772462D909E5A8 ),
              ( 0x377F4E2380FD20F6, 0x3F886AF0AE6DF23C, 0x47611212B6E0C0B6, 0x203B070E18D179E3 ),
              ( 0xBBEA67F79ED0A639, 0x2348E7B04B8FE61F, 0xC4A0C4BDD549E690, 0x4002E63DD2FAACBB ),
              ( 0x5BD7374482BCD0AE, 0xE465F7287EA1095B, 0x4F9713BAFD0E5037, 0xED98AE740EF44907 ),
              ( 0x9D12266D61EF2E4B, 0x3F82247049FFDACF, 0x01DA8A38AC6DB80D, 0x6D791887DB7BC086 ),
              ( 0xCF409F3F352535F6, 0x0E03BB546CA18FF7, 0xF1FD88CBBC37921F, 0x6D6F5580D65BB572 ),
              ( 0xA15E9AA4D3881354, 0xF042F1E89CECFFD3, 0x2C3DF0918FBD9D82, 0xE3104F8E503EEEB7 ),
              ( 0xF487F38AFF72BCE1, 0x99081BA0BCA194B5, 0x2B8AA44DCF5F3898, 0x8F7C4CF6C564757A )
            ]
    }

    return x[w][i]




if __name__ == '__main__':

    # check G function
    for ws in [32,64]:
        norx = NORX(w = ws)
        x = (1, 0, 0, 0)
        for i in xrange(16):
            #s = ''.join(["{:0",str(ws/4),"X}, {:0",str(ws/4),"X}, {:0",str(ws/4),"X}, {:0",str(ws/4),"X}"])
            #print s.format(x[0],x[1],x[2],x[3])
            assert vectors_G(ws,i) == x
            x = tuple(norx.G(x[0],x[1],x[2],x[3]))
        print "NORX{}, G: all tests passed.".format(ws)

